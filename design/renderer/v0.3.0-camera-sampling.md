# v0.3.0 카메라 및 멀티샘플링 설계

## 목표
- 수직 시야각과 종횡비를 갖는 핀홀 카메라를 도입해 뷰포트가 해상도에 따라 자연스럽게 조정되도록 한다.
- 픽셀당 다중 샘플을 균일 분포 난수로 분산시켜 안티앨리어싱을 적용한다.
- 고정 시드를 통해 두 번 실행해도 동일한 PPM 문자열이 생성되도록 결정성을 유지한다.

## 카메라 구성
- 입력: 수직 FOV(기본 90도), 해상도 기반 종횡비(`width/height`).
- 변환:
  - `theta = rad(FOV)`, `viewport_height = 2 * tan(theta/2)`, `viewport_width = aspect * viewport_height`.
  - 원점은 `(0,0,0)`, 초점 거리는 `1.0`으로 고정한다.
  - 수평/수직 벡터와 좌하단 코너는 contract 규칙을 따른다.
- 레이 생성: 정규화 좌표 `(u, v)`를 받아 `origin`에서 `lower_left_corner + u*horizontal + v*vertical - origin` 방향을 가진다.

## 멀티샘플링/난수
- 난수기: `std::mt19937`와 `std::uniform_real_distribution<double>(0.0, 1.0)`을 사용한다.
- 시드: CLI `--seed`(기본 1)로 초기화해 전 실행에서 동일한 난수열을 보장한다.
- 픽셀 샘플링:
  - 픽셀 `(x, y)`에 대해 `u = (x + rand01)/(width-1)`, `v = (height-1 - y + rand01)/(height-1)`을 사용해 상단 원점을 유지한다. `width`나 `height`가 1이면 각각 `0.5`를 사용한다.
  - 샘플을 모두 합산 후 `samples_per_pixel`로 나누어 평균을 얻고 감마 보정을 생략한다.

## CLI와 기본값
- `--width`, `--height`: 기본 256, 1 이상 정수.
- `--spp`: 기본 10, 1 이상 정수.
- `--seed`: 기본 1, 0 이상 32비트 정수. 범위 밖 값은 즉시 오류 처리한다.
- 옵션과 픽셀 좌표계, 샘플링 정의는 `design/protocol/contract.md`를 정본으로 한다.

## 테스트/결정성 전략
- 통합 테스트 1: 3x2 해상도, 4 SPP, 시드 1의 결과 문자열을 스냅샷으로 고정해 카메라와 샘플링 공식을 검증한다.
- 통합 테스트 2: 동일 옵션/시드로 두 번 렌더링한 문자열을 비교해 결정성을 확인한다.
- `./verify.sh`는 Release 빌드 후 단위/통합 테스트를 모두 실행한다.
