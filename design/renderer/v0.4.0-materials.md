# v0.4.0 재질 및 재귀 색 계산 설계

## 목표
- Lambertian/Metal/Dielectric 재질을 도입해 반사/굴절을 표현한다.
- rayColor 재귀와 `max_depth`로 경로 길이를 제어한다.
- 감마 보정(gamma=2.0) 정책을 고정한다.

## 장면 구성
- 고정 월드: 4개 구
  - Ground: 중심 `(0, -100.5, -1)`, 반지름 `100`, `Lambertian(0.8, 0.8, 0.0)`
  - Center: 중심 `(0, 0, -1)`, 반지름 `0.5`, `Lambertian(0.1, 0.2, 0.5)`
  - Left: 중심 `(-1, 0, -1)`, 반지름 `0.5`, `Dielectric(1.5)`
  - Right: 중심 `(1, 0, -1)`, 반지름 `0.5`, `Metal(0.8, 0.6, 0.2, fuzz=0.0)`
- `HittableList`가 가장 가까운 교차를 선택해 `HitRecord`에 재질 포인터를 채운다.

## 재질 구현 요약
- `Material::Scatter` 인터페이스에 RNG(`std::mt19937&`)를 인자로 전달한다.
- Lambertian: 법선 + 단위 구 난수 벡터. Near-zero면 법선 사용. 감쇠는 알베도.
- Metal: 반사 벡터 + `fuzz * RandomInUnitSphere`. 법선과 같은 반공간이 아닐 경우 산란 실패.
- Dielectric: 내부/외부에 따라 `eta` 설정, 전반사 조건으로 반사 강제. 슐릭 근사로 반사/굴절 선택. 감쇠 `(1,1,1)`.

## rayColor 규칙
- `depth <= 0`이면 `(0,0,0)` 반환.
- 히트 시 `Scatter` 성공이면 `attenuation * rayColor(scattered, depth-1)`.
- 미히트 시 기존 그라디언트 배경 사용.
- `t_min=0.001`로 자기 교차 방지.

## 샘플링 및 결정성
- 난수: `std::mt19937` + `std::uniform_real_distribution<double>(0.0, 1.0)`.
- 모든 샘플과 산란에서 동일 생성기를 직렬로 소비해 시드 기반 결정성을 유지한다.
- 픽셀 u/v 계산, 카메라, 배경 규칙은 v0.3.0과 동일.

## 색 변환
- 픽셀 평균 색상에 감마 보정(gamma=2.0) 적용: `sqrt(channel)`.
- 각 채널을 [0, 0.999]로 클램프 후 `round(255 * value)`.

## 테스트 포인트
- 단위: 재질 산란(감쇠 유지, 반사/굴절 방향) 3개 케이스.
- 통합: (width=3,height=2,spp=4,seed=1,max_depth=5) PPM 문자열 정확 비교 + 동일 시드 반복一致 검증.
